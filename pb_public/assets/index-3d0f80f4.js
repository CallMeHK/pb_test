import{l as p,a as $,d as C,h as R,x,P as X}from"./preact-bfe5487e.js";import{u as Y,S as q,R as T,a as ee}from"./wouter-preact-1b87a2ff.js";import{a as te,u as b,_ as oe,b as S,h as L,T as O,F as ne}from"./@preact/signals-4e3ecbd2.js";import{C as re}from"./pocketbase-05c1a5be.js";import{p as le}from"./preact-markdown-b1dbf714.js";/* empty css                      */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();const se="modulepreload",ce=function(e){return"/"+e},P={},M=function(t,n,o){if(!n||n.length===0)return t();const l=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=ce(r),r in P)return;P[r]=!0;const c=r.endsWith(".css"),i=c?'[rel="stylesheet"]':"";if(!!o)for(let _=l.length-1;_>=0;_--){const f=l[_];if(f.href===r&&(!c||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${i}`))return;const a=document.createElement("link");if(a.rel=c?"stylesheet":se,c||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),c)return new Promise((_,f)=>{a.addEventListener("load",_),a.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())};console.log("using backend: ","https://beer.tylergregg.me");const d=new re("https://beer.tylergregg.me");window.pb=d;const w=b({}),g=b(!1),A=b(!1);d.authStore.onChange(()=>{var e,t,n,o,l,r,c,i,u,a,_,f,h,m;if(console.log("running auth onchange..."),g.value!==d.authStore.isValid&&(console.log("setting is_authenticated",d.authStore.isValid),g.value=d.authStore.isValid),!((e=w.value)!=null&&e.id)&&!A.value)try{console.log("running auth refresh"),A.value=!0,d.collection("users").authRefresh()}catch{}((n=(t=d.authStore)==null?void 0:t.baseModel)==null?void 0:n.id)!==((o=w.value)==null?void 0:o.id)&&(console.log("setting user_data to",(r=(l=d.authStore)==null?void 0:l.baseModel)==null?void 0:r.id),w.value=(i=(c=d.authStore)==null?void 0:c.baseModel)!=null&&i.id?{id:(a=(u=d.authStore)==null?void 0:u.baseModel)==null?void 0:a.id,username:(f=(_=d.authStore)==null?void 0:_.baseModel)==null?void 0:f.username,email:(m=(h=d.authStore)==null?void 0:h.baseModel)==null?void 0:m.email}:{})},!0);te(()=>{console.log("auth data updated",g.value,w.value)});const Ie=async(e,t)=>{try{return await d.collection("users").authWithPassword(e,t),{success:!0}}catch(n){return console.error("failed login",n),{success:!1,error:n}}},ie=()=>d.authStore.clear(),U=b(0);var ae=0;function s(e,t,n,o,l){var r,c,i={};for(c in t)c=="ref"?r=t[c]:i[c]=t[c];var u={type:e,props:i,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--ae,__source:l,__self:o};if(typeof e=="function"&&(r=e.defaultProps))for(c in r)i[c]===void 0&&(i[c]=r[c]);return p.vnode&&p.vnode(u),u}const k=({children:e,onClick:t})=>s("li",{children:s("a",{href:"#",onClick:t,children:e})}),ue=()=>{const[e,t]=Y(),n=oe(),o=r=>{ie(),r.preventDefault(),n.current.open=!1},l=r=>c=>{c.preventDefault(),t(r),n.current.open=!1};return s("nav",{className:"container-fluid",children:[s("ul",{children:s("li",{children:s("a",{href:"./",className:"contrast",onClick:l("/"),children:[s("img",{src:"./beer-mug-icon.svg",style:{height:"22px",marginRight:"8px",marginBottom:"5px"}}),s("strong",{children:"beer.tylergregg"})]})})}),s("ul",{children:s("li",{children:s("details",{role:"list",dir:"rtl",ref:n,children:[s("summary",{"aria-haspopup":"listbox",role:"link",className:"secondary",children:"Menu"}),s("ul",{role:"listbox",children:[s(k,{onClick:l("/"),children:"Home"}),g.value&&s(k,{onClick:l("/todos"),children:"Todos"}),g.value&&s(k,{onClick:l("/chat"),children:"Chat"}),g.value&&s(k,{onClick:o,children:"Sign out"}),!g.value&&s(k,{onClick:l("/signin"),children:"Sign in"})]})]})})})]})},_e=({id:e,children:t})=>s("main",{className:"container",...!!e&&{id:e},children:t}),v=b([]),We=e=>{var c;const t=S(!0),n=S(null);L(()=>{const{subscription:i,skip:u,...a}=e||{sort:"-created"};u||d.collection("todos").getFullList(200,a).then(_=>{t.value=!1,v.value=_}).catch(_=>{t.value=!1,n.value=_})},[e]);const o=O(async i=>{try{const u=await d.collection("todos").create({...i,user:w.value.id});return v.value=[u,...v.value],console.log("successfully created todo"),{success:!0}}catch(u){return console.log("could not create todo: ",u),{success:!1,error:u}}},[]),l=O(async i=>{try{const u=await d.collection("todos").delete(i);return v.value=v.value.filter(a=>a.id!==i),console.log("successfully deleted todo"),{success:!0,data:u}}catch(u){return console.log("could not delete todo: ",u),{success:!1,error:u}}},[]),r=O(async(i,u)=>{try{console.log("updated todo: ",i,{text:u.text,done:u.done,user:u.user});const a=await d.collection("todos").update(i,u);return v.value=v.value.map(_=>_.id===i?a:_),console.log("successfully updated todo"),{success:!0,data:a}}catch(a){return console.log("could not update todo: ",a),{success:!1,error:a}}},[]);return L(()=>{var i,u,a;if((i=e==null?void 0:e.subscription)!=null&&i.event){const _=((u=e==null?void 0:e.subscription)==null?void 0:u.callback)||(f=>{console.log("subscription event recieved: ",f)});return console.log("subscribing to * todos"),d.collection("todos").subscribe((a=e==null?void 0:e.subscription)==null?void 0:a.event,_),()=>{var f;console.log("unsubscribing to * todos"),d.collection("todos").unsubscribe((f=e==null?void 0:e.subscription)==null?void 0:f.event)}}},[(c=e==null?void 0:e.subscription)==null?void 0:c.run,e]),{loading:t.value,todos:v.value,error:n.value,createTodo:o,deleteTodo:l,updateTodo:r}},G=(e,t)=>n=>{var u;const o=ne(()=>n||{},[n]),l=t||S([]),r=S(!(o!=null&&o.skipMountFetch)),c=S(null);L(()=>{const{subscription:a,skipMountFetch:_,...f}=o;_||(console.info(` - Fetching ${e} collection...`),r.value=!0,d.collection(e).getFullList(200,{sort:"-created",...f}).then(h=>{r.value=!1,l.value=h,console.info(` - Successfully fetched ${e} collection.`)}).catch(h=>{r.value=!1,c.value=h,console.error(` - Failed to fetch ${e} collection.`)}))},[o]);const i=O(async(a,_={update:!1})=>{try{console.info(` - Creating new ${e}...`);const f=await d.collection(e).create(a);return console.info(` - Successfully created ${e}.`),_.update&&(l.value=[f,...l.value]),{success:!0,data:f}}catch(f){return console.error(` - Failed to create ${e}.`),{success:!1,error:f}}},[]);return L(()=>{var a,_,f;if((a=o==null?void 0:o.subscription)!=null&&a.event){const h=((_=o==null?void 0:o.subscription)==null?void 0:_.callback)||(m=>{console.log(`subscription event ${e} recieved: `,m)});return console.log(`subscribing to * ${e}`),d.collection(e).subscribe((f=o==null?void 0:o.subscription)==null?void 0:f.event,h),()=>{var m;console.log(`unsubscribing to * ${e}`),d.collection(e).unsubscribe((m=o==null?void 0:o.subscription)==null?void 0:m.event)}}},[(u=o==null?void 0:o.subscription)==null?void 0:u.event,o]),{data:l.value,loading:r.value,error:c.value,create:i}},de="users",fe=b([]),Be=G(de,fe);b([]);const pe="pmessage",he=b([]),He=G(pe,he),ve=()=>(L(()=>{console.log(U.value)},[U.value]),s($,{children:s(_e,{children:s("section",{id:"preview",children:[s("h2",{children:"Preview"}),s("p",{children:"Sed ultricies dolor non ante vulputate hendrerit. Vivamus sit amet suscipit sapien. Nulla iaculis eros a elit pharetra egestas."}),s(le,{markdown:"**Hello** _World_!"}),s("form",{children:[s("div",{className:"grid",children:[s("input",{type:"text",name:"firstname",placeholder:"First name","aria-label":"First name",required:""}),s("input",{type:"email",name:"email",placeholder:"Email address","aria-label":"Email address",required:""}),s("button",{type:"submit",children:"Subscribe"})]}),s("fieldset",{children:s("label",{for:"terms",children:[s("input",{type:"checkbox",role:"switch",id:"terms",name:"terms"}),"I agree to the"," ",s("a",{href:"#",onClick:e=>e.preventDefault(),children:"Privacy Policy"})]})})]})]})})}));function ge(e,t){for(var n in t)e[n]=t[n];return e}function V(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var o in t)if(o!=="__source"&&e[o]!==t[o])return!0;return!1}function D(e){this.props=e}(D.prototype=new C).isPureReactComponent=!0,D.prototype.shouldComponentUpdate=function(e,t){return V(this.props,e)||V(this.state,t)};var I=p.__b;p.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),I&&I(e)};var be=p.__e;p.__e=function(e,t,n,o){if(e.then){for(var l,r=t;r=r.__;)if((l=r.__c)&&l.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),l.__c(e,t)}be(e,t,n,o)};var W=p.unmount;function K(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(o){typeof o.__c=="function"&&o.__c()}),e.__c.__H=null),(e=ge({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(o){return K(o,t,n)})),e}function J(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(o){return J(o,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function y(){this.__u=0,this.t=null,this.__b=null}function Q(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function F(e){var t,n,o;function l(r){if(t||(t=e()).then(function(c){n=c.default||c},function(c){o=c}),o)throw o;if(!n)throw t;return R(n,r)}return l.displayName="Lazy",l.__f=!0,l}function E(){this.u=null,this.o=null}p.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),W&&W(e)},(y.prototype=new C).__c=function(e,t){var n=t.__c,o=this;o.t==null&&(o.t=[]),o.t.push(n);var l=Q(o.__v),r=!1,c=function(){r||(r=!0,n.__R=null,l?l(i):i())};n.__R=c;var i=function(){if(!--o.__u){if(o.state.__a){var a=o.state.__a;o.__v.__k[0]=J(a,a.__c.__P,a.__c.__O)}var _;for(o.setState({__a:o.__b=null});_=o.t.pop();)_.forceUpdate()}},u=t.__h===!0;o.__u++||u||o.setState({__a:o.__b=o.__v.__k[0]}),e.then(c,c)},y.prototype.componentWillUnmount=function(){this.t=[]},y.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=K(this.__b,n,o.__O=o.__P)}this.__b=null}var l=t.__a&&R($,null,e.fallback);return l&&(l.__h=null),[R($,null,t.__a?null:e.children),l]};var B=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(E.prototype=new C).__a=function(e){var t=this,n=Q(t.__v),o=t.o.get(e);return o[0]++,function(l){var r=function(){t.props.revealOrder?(o.push(l),B(t,e,o)):l()};n?n(r):r()}},E.prototype.render=function(e){this.u=null,this.o=new Map;var t=x(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},E.prototype.componentDidUpdate=E.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){B(e,n,t)})};var me=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ye=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ke=typeof document<"u",Se=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};C.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(C.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var H=p.event;function we(){}function Ce(){return this.cancelBubble}function Le(){return this.defaultPrevented}p.event=function(e){return H&&(e=H(e)),e.persist=we,e.isPropagationStopped=Ce,e.isDefaultPrevented=Le,e.nativeEvent=e};var N={configurable:!0,get:function(){return this.class}},z=p.vnode;p.vnode=function(e){var t=e.type,n=e.props,o=n;if(typeof t=="string"){var l=t.indexOf("-")===-1;for(var r in o={},n){var c=n[r];ke&&r==="children"&&t==="noscript"||r==="value"&&"defaultValue"in n&&c==null||(r==="defaultValue"&&"value"in n&&n.value==null?r="value":r==="download"&&c===!0?c="":/ondoubleclick/i.test(r)?r="ondblclick":/^onchange(textarea|input)/i.test(r+t)&&!Se(n.type)?r="oninput":/^onfocus$/i.test(r)?r="onfocusin":/^onblur$/i.test(r)?r="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(r)?r=r.toLowerCase():l&&ye.test(r)?r=r.replace(/[A-Z0-9]/g,"-$&").toLowerCase():c===null&&(c=void 0),/^oninput$/i.test(r)&&(r=r.toLowerCase(),o[r]&&(r="oninputCapture")),o[r]=c)}t=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=x(n.children).forEach(function(i){i.props.selected=o.value.indexOf(i.props.value)!=-1})),t=="select"&&o.defaultValue!=null&&(o.value=x(n.children).forEach(function(i){i.props.selected=o.multiple?o.defaultValue.indexOf(i.props.value)!=-1:o.defaultValue==i.props.value})),e.props=o,n.class!=n.className&&(N.enumerable="className"in n,n.className!=null&&(o.class=n.className),Object.defineProperty(o,"className",N))}e.$$typeof=me,z&&z(e)};var j=p.__r;p.__r=function(e){j&&j(e),e.__c};const Z=({path:e,component:t})=>s(T,{path:e,component:g.value?t:()=>s(ee,{to:"/signin"})}),Ee=F(()=>M(()=>import("./SignInPage-78466994.js"),["assets/SignInPage-78466994.js","assets/wouter-preact-1b87a2ff.js","assets/@preact/signals-4e3ecbd2.js","assets/preact-bfe5487e.js","assets/pocketbase-05c1a5be.js","assets/preact-markdown-b1dbf714.js","assets/pico-17913ccb.css"]).then(e=>({default:e.SignInPage}))),Oe=F(()=>M(()=>import("./ChatPage-5b97533c.js"),["assets/ChatPage-5b97533c.js","assets/wouter-preact-1b87a2ff.js","assets/@preact/signals-4e3ecbd2.js","assets/preact-bfe5487e.js","assets/pocketbase-05c1a5be.js","assets/preact-markdown-b1dbf714.js","assets/pico-17913ccb.css"]).then(e=>({default:e.ChatPage}))),$e=F(()=>M(()=>import("./TodoPage-f8728ea7.js"),["assets/TodoPage-f8728ea7.js","assets/wouter-preact-1b87a2ff.js","assets/@preact/signals-4e3ecbd2.js","assets/preact-bfe5487e.js","assets/pocketbase-05c1a5be.js","assets/preact-markdown-b1dbf714.js","assets/pico-17913ccb.css"]).then(e=>({default:e.TodoPage}))),Re=()=>s(y,{fallback:null,children:s(Ee,{})}),xe=()=>s(y,{fallback:null,children:s($e,{})}),Te=()=>s(y,{fallback:null,children:s(Oe,{})}),Me=()=>s($,{children:[s(ue,{}),s(q,{children:[s(T,{path:"/signin",component:Re}),s(Z,{path:"/todos",component:xe}),s(Z,{path:"/chat",component:Te}),s(T,{path:"/",component:ve})]})]});X(s(Me,{}),document.querySelector("body"));export{_e as M,w as a,Be as b,We as c,g as i,Ie as l,s as o,he as p,He as u};
